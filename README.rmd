---
title: "rvalidate"
date: "`r Sys.Date()`"
output:
  html_document:
    keep_md: TRUE
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
devtools::load_all()
options(kableExtra.table.format = "html") 
```


## Table of Contents
1. [Introduction](#intro)
2. [Error tables](#2)
3. [Coverage tables](#3)
4. [Statistics for multiple observations per group](#4)
  
## <a name="intro"></a>
## Introduction
rvalidate computes validation statistics for models and draw up aesthetic tables and plots. Supports error, coverage, and Probability integral transforms. Input data should be formated as our simulated data. See `rvalidate::rv_data` below
```{r}
library(rvalidate)
rv_data %>% head() %>% kableExtra::kable()
```


## <a name="2"></a>
## Error tables
```{r, warning = FALSE}
rv_error(data = rv_data, 
           parameter = "observed_value", 
           estimate = "50%", 
           total_standard_error = "totalerror_sd",
           subset = "source")  %>%
  kableExtra::kable() %>%
  kableExtra::column_spec(1:2, bold = T) %>%
  kableExtra::collapse_rows(columns = 1:2, valign = "top") 
```

## <a name="3"></a>
## Coverage tables
If provided a subset column name, coverage will be calculate for each subset.
```{r}
rv_coverage(data = rv_data, 
         parameter = "observed_value", 
         lower = "2.5%", 
         upper = "97.5%", 
         subset = "source")  %>%
  kableExtra::kable() %>%
  kableExtra::column_spec(1, bold = T)
```

## <a name="4"></a>
## Statistics for data with multiple observations within a grouping
For data containing multiple observations per group (e.g. country-year you) we compute statistics for all unique permutations of the data where there is only one observation from each group in each permutation. Note the run time will increase substantially as the number of multiple observations increase.

### Error
```{r, warning = FALSE}
rv_error_multiple(data = rv_data, 
           parameter = "observed_value", 
           estimate = "50%", 
           total_standard_error = "total_sd",
           subset = "source",
           group_to_check = c("country_code", "year"))  %>%
  kableExtra::kable() %>%
  kableExtra::column_spec(1:2, bold = T) %>%
  kableExtra::collapse_rows(columns = 1:2, valign = "top") 
```

### Coverage
```{r}
rv_coverage_multiple(data = rv_data, 
         parameter = "observed_value", 
         lower = "2.5%", 
         upper = "97.5%", 
         subset = "source",
         group_to_check = c("country_code", "year"))  %>%
  kableExtra::kable() %>%
  kableExtra::column_spec(1:2, bold = T) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")

```

